---
layout: single
title: "7. 영역처리"
categories: opencv
---

# 0) 도입
* 커널: 마스크, 윈도우, 필터

---

# 1) 회선
# 1.1) 공간 영역의 개념과 회선
* 마스크 기반 처리: 마스크 내의 원소값과 공간 영역에 있는 입력 영상의 화소값들을 대응되게 곱하여 출력 화소값을 계산
* 회선: 마스크 기반 처리를 모든 출력 화소값에 대해 이동하면서 수행하는 것

# 1.2) 블러링
* 블러링, 스무딩: 영상에서 화소값이 급격하게 변하는 부분들을 감소시켜 점진적으로 변하게함으로써 영상이 전체적으로 부드러운 느낌이 나게 하는 기술, 모든 원소의 값을 같게 마스크를 구성하여 회선을 수행

# 1.3) 샤프닝
* 샤프닝: 입력 화소에서 이웃 화소끼리 차이가 크게 되도로 출력 화소를 만들어서 날카로운 느낌이 나게 만드는 것, 경계 부분에서 명암대비증가

---
# 2) 에지 검출
* 에지: 물체의 윤곽선, 경계선, 화소값이 급격하게 변화하는 부분
* 에지 검출: 에지에 해당하는 화소들을 찾는 과정

# 2.1) 1차 미분 마스크
* 미분: 순간 변화율
* 1차 미분 마스크: x,y방향으로 편미분
* 로버츠 마스크: 대각선 방향으로 1, -1 배치, 계산 단순, 한번만 차분 계산, 경계가 확실한 에지만을 추출, 잡음에 매우 민감
* 프리윗 마스크: 로버츠 마스크의 단점 보완, 원소, 에지의 배치가 수직 방향으로 구성(수직 마스크), 세번의 차분을 합함, 에지의 강도가 강함
* 소벨 마스크: 대표적인 1차 미분 마스크, 프리윗과 유사하지만 중심계수의 차분에 대한 비중을 2배로 함, 중심계수 차분 비중을 높여서 대각선 방향의 에지도 잘 검출

# 2.2) 2차 미분 마스크
* 2차 미분 마스크: 1차는 점진적으로 변화하는 부분까지 민감하게 에지를 검출하므로 너무 많은 에지가 나타날 수 있음, 1차 미분에서 한번 더 미분
* 라플라시안: 4방향, 8방향, 잡음에 민감
* LoG: 라플라시안 of 가우시안, 잡음 제거 후 라플라시안
* DoG: 디프런스 of 가우시안
* 캐니 에지 검출: 대부분의 에지 검출이 잡음들을 에지로 검출하게 됨 이 문제를해결하는 방법
    1. 블러링을 통한 노이즈 제거(가우시안 블러링)
    2. 화소 기울기(그래디언트)의 강도와 방향 검출(소벨 마스크)
    3. 비최대치 억제: 현재 화소가 이웃하는 화소들보다 크면 에지, 그렇지 않으면 에지가 아닌것으로 간주하여 제거
    4. 이력 임계값으로 에지 결정
---

# 3) 기타 필터링
비선형  공간 필터링

## 3.1) 최댓값/최솟값 필터링
* 원리: 마스크 계수 중에서 최댓/최솟값 -> 출력화소
* 기대효과(최댓값)
    1. 최댓값 필터링의 경우 밝은 색들로 출력 화소가 구성됨
    2. 돌출되는 어두운 값 제거
    3. 전체적으로 밝은 영상
    4. 밝은 임펄스 잡음이 강조됨

## 3.2) 평균값 필터링
* 원리: 마스크로 씌워진 영역의 입력 화소 -> 화소들의 평균을 출력화소로 지정
* 기대효과
    1. 블러링 효과(블러링 마스크와 결과가 같음)
* 상하좌우 경계 화소값 결정 방법: borderType

## 3.3) 미디언 필터링
* 원리
    1. 입력 화소 중심으로 마스킹 -> 입력 화소들을 가져옴
    2. 마스크 범위 내의 화소값들을 크기순으로 정렬
    3. 중간값을 출력화소로 지정
* 기대효과
    1. 임펄스 잡음, 소금-후추 잡음 제거
    2. 평균값 필터링에 비해 블러링 현상이 적음
* 단점: 정렬 알고리즘으로 인해 수행시간 증가
* rgb공간에서는 채널간의 상호의존도가 크므로 사용되지 않음(한 채널에서 심한것이 다른채널에선 아닐 수 있음)

## 3.4) 가우시안 스무딩 필터링
* 스무딩: 영상의 세세한 부분을 회선을 통해서 부드럽게 하는 기법, 블러링
* 가우시안 분포: 정규분포
* 원리: 2차원 가우시안 분포 값으로 마스크를 구성 -> 회선 수행
* 주의: 마스크 계수 전체 합이 1이 되어야 입력 영상의 밝기 유지 가능
* 기대효과
    1. 표준편차가 클수록 흐림의 정도가 심해짐(블러링 마스크와 유사해짐)
    2. 표준편차가 작을수록 중심화소의 비중이 커지므로, 흐림의 정도가 약화됨
---

# 4) 모폴로지
모폴로지: 형태학, 영상의 객체들의 형태를 분석하고 처리하는 기법, 객체의 형태를 변형

## 4.1) 침식연산
* 정의: 객체를 침식시키는 연산
* 기대효과
    * 객체의 크기 축소 -> 작은 크기의 객체(잡음) 사라질 수 있음
    * 배경 확장
    * 돌출부 감소 -> 서로 닿는 물체 분리
* 원리
    * 침식마스크의 마스크 원소가 한개의 화소라도 일치하지 않으면 출력화소는 0
    * 모두 일치하면 출력화소 1

## 4.2) 팽창연산
* 정의: 객체를 팽창시키는 연산
* 기대효과
    * 객체의 외곽 화소 확장
    * 객체의 크기 확대 -> 객체 내부의 빈 공간이 메워짐
    * 배경 축소
* 원리
    * 팽창마스크의 마스크 원소가 한개의 화소라도 일치하면 출력화소 1
    * 모두 불일치하면 0

## 4.3) 열림 연산, 닫힘 연산
* 원리
    * 침식 연산 + 팽창 연산 조합
* 열림 연산: 침식 연산 -> 팽창 연산
    * 효과: 돌출된 부분은 제거된 후 다시 원래 크기로 돌아가지 않는다.
* 닫힘 연산: 팽창 연산 -> 침식 연산
    * 효과: 인접한 객체를 이어지게 함